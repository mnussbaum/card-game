---
min_player_count: 2
max_player_count: 4

player_hand:
  blind_cards:
    initial_deal_count: 3
    visibility: FaceDown
  lower_cards:
    initial_deal_count: 3
    visibility: FaceUp
  hand_cards:
    initial_deal_count: 3
    visibility: VisibleToOwner

communal_cards:
  draw_pile:
    visibility: FaceDown
  active_pile:
    visibility: TopFaceUpRestFaceDown
    initial_deal_count: 0
  discard_pile:
    initial_deal_count: 0
    visibility: FaceDown

cards:
  Two:
    value: Wild
    consequences:
      - description: "Next player's turn"
        verb: MoveNextTurn
        object:
          RelativePlayer:
            offset_from_current_player: 1
  Three:
    value: Wild
    consequences:
      - description: "Threes are wild and make the next player _pick-up the deck_ their turn"
        verb: MoveCards
        object:
          CardMove:
            card_group_name_source:
              owner:
                Name: communal_cards
              name: active_pile
            card_group_name_dest:
              owner:
                RelativePlayer:
                  offset_from_current_player: 1
              name: hand_cards
      - description: "Threes are wild and make the next player pick-up the deck _as their turn_"
        verb: MoveNextTurn
        object:
          RelativePlayer:
            offset_from_current_player: 2
  Four:
    value:
      Numeric: 1
    consequences:
      - description: "Cards must be same rank or higher than the last played card"
        verb: ConstrainPlayableCards
        object:
          MinimumPlayableCard: LastPlayedCard
      - description: "Next player's turn"
        verb: MoveNextTurn
        object:
          RelativePlayer:
            offset_from_current_player: 1
  Five:
    value:
      Numeric: 2
    consequences:
      - description: "Cards must be same rank or higher than the last played card"
        verb: ConstrainPlayableCards
        object:
          MinimumPlayableCard: LastPlayedCard
      - description: "Next player's turn"
        verb: MoveNextTurn
        object:
          RelativePlayer:
            offset_from_current_player: 1
  Six:
    value:
      Numeric: 3
    consequences:
      - description: "Cards must be same rank or higher than the last played card"
        verb: ConstrainPlayableCards
        object:
          MinimumPlayableCard: LastPlayedCard
      - description: "Next player's turn"
        verb: MoveNextTurn
        object:
          RelativePlayer:
            offset_from_current_player: 1
  Seven:
    value:
      Numeric: 4
    consequences:
      - description: "Cards must be same rank or higher than the last played card"
        verb: ConstrainPlayableCards
        object:
          MinimumPlayableCard: LastPlayedCard
      - description: "Next player's turn"
        verb: MoveNextTurn
        object:
          RelativePlayer:
            offset_from_current_player: 1
  Eight:
    value:
      Numeric: 5
    consequences:
      - description: "Cards must be same rank or higher than the last played card"
        verb: ConstrainPlayableCards
        object:
          MinimumPlayableCard: LastPlayedCard
      - description: "Next player's turn"
        verb: MoveNextTurn
        object:
          RelativePlayer:
            offset_from_current_player: 1
  Nine:
    value:
      Numeric: 6
    consequences:
      - description: "Cards must be same rank or higher than the last played card"
        verb: ConstrainPlayableCards
        object:
          MinimumPlayableCard: LastPlayedCard
      - description: "Next player's turn"
        verb: MoveNextTurn
        object:
          RelativePlayer:
            offset_from_current_player: 1
  Ten:
    value: Wild
    consequences:
      - description: "Tens are wild, _discard the active pile_, and let the player play again"
        verb: MoveCards
        object:
          CardMove:
            card_group_name_source:
              owner:
                Name: communal_cards
              name: active_pile
            card_group_name_dest:
              owner:
                Name: communal_cards
              name: discard_pile
      - description: "Tens are wild, discard the active pile, and _let the player play again_"
        verb: MoveNextTurn
        object:
          RelativePlayer:
            offset_from_current_player: 0
  Jack:
    value:
      Numeric: 7
    consequences:
      - description: "Cards must be same rank or higher than the last played card"
        verb: ConstrainPlayableCards
        object:
          MinimumPlayableCard: LastPlayedCard
      - description: "Next player's turn"
        verb: MoveNextTurn
        object:
          RelativePlayer:
            offset_from_current_player: 1
  Queen:
    value:
      Numeric: 8
    consequences:
      - description: "Cards must be same rank or higher than the last played card"
        verb: ConstrainPlayableCards
        object:
          MinimumPlayableCard: LastPlayedCard
      - description: "Next player's turn"
        verb: MoveNextTurn
        object:
          RelativePlayer:
            offset_from_current_player: 1
  King:
    value:
      Numeric: 9
    consequences:
      - description: "Cards must be same rank or higher than the last played card"
        verb: ConstrainPlayableCards
        object:
          MinimumPlayableCard: LastPlayedCard
      - description: "Next player's turn"
        verb: MoveNextTurn
        object:
          RelativePlayer:
            offset_from_current_player: 1
  Ace:
    value:
      Numeric: 10
    consequences:
      - description: "Cards must be same rank or higher than the last played card"
        verb: ConstrainPlayableCards
        object:
          MinimumPlayableCard: LastPlayedCard
      - description: "Next player's turn"
        verb: MoveNextTurn
        object:
          RelativePlayer:
            offset_from_current_player: 1

turn_actions:
  - description: "During setup you can swap cards between your lower cards and hand"
    verb: SwapCards
    object:
      CardSwap:
        first_card_group_name:
          owner:
            RelativePlayer:
              offset_from_current_player: 0
          name: hand_cards
        second_card_group_name:
          owner:
            RelativePlayer:
              offset_from_current_player: 0
          name: lower_cards
    conditions:
      - MustBeInTurnRange:
          min: 0
          max: 0
  - description: "Play from your hand"
    verb: MoveCards
    conditions:
      - MustBeInTurnRange:
          min: 1
      - CardGroupSize:
          card_group_name:
            owner:
              RelativePlayer:
                offset_from_current_player: 0
            name: hand_cards
          operator: GreaterThanOrEqual
          compare_to: 0
    object:
      CardMove:
        card_group_name_source:
          owner:
            RelativePlayer:
              offset_from_current_player: 0
          name: hand_cards
        card_group_name_dest:
          owner:
            Name: communal_cards
          name: active_pile
        conditions:
          - CardsMustBeSameRank
  - description: "Play from your lower cards"
    verb: MoveCards
    conditions:
      - MustBeInTurnRange:
          min: 1
      - CardGroupSize:
          card_group_name:
            owner:
              RelativePlayer:
                offset_from_current_player: 0
            name: lower_cards
          operator: GreaterThanOrEqual
          compare_to: 0
      - CardGroupSize:
          card_group_name:
            owner:
              RelativePlayer:
                offset_from_current_player: 0
            name: hand_cards
          operator: Equal
          compare_to: 0
    object:
      CardMove:
        card_group_name_source:
          owner:
            RelativePlayer:
              offset_from_current_player: 0
          name: lower_cards
        card_group_name_dest:
          owner:
            Name: communal_cards
          name: active_pile
        conditions:
          - CardsMustBeSameRank
  - description: "Play from your blind cards"
    verb: MoveCards
    conditions:
      - MustBeInTurnRange:
          min: 1
      - CardGroupSize:
          card_group_name:
            owner:
              RelativePlayer:
                offset_from_current_player: 0
            name: lower_cards
          operator: Equal
          compare_to: 0
      - CardGroupSize:
          card_group_name:
            owner:
              RelativePlayer:
                offset_from_current_player: 0
            name: hand_cards
          operator: Equal
          compare_to: 0
    object:
      CardMove:
        card_group_name_source:
          owner:
            RelativePlayer:
              offset_from_current_player: 0
          name: blind_cards
        card_group_name_dest:
          owner:
            Name: communal_cards
          name: active_pile
        conditions:
          - CardsMustBeSameRank
  - description: "Pick-up the active pile into your hand"
    verb: MoveCards
    conditions:
      - MustBeInTurnRange:
          min: 1
    object:
      CardMove:
        card_group_name_source:
          owner:
            Name: communal_cards
          name: active_pile
        card_group_name_dest:
          owner:
            RelativePlayer:
              offset_from_current_player: 0
          name: hand_cards
  - description: "Draw a card from the draw pile to endyour turn"
    verb: MoveCards
    conditions:
      - MustBeInTurnRange:
          min: 1
      - CardGroupSize:
          card_group_name:
            owner:
              Name: communal_cards
            name: draw_pile
          operator: GreaterThan
          compare_to: 0
    object:
      CardMove:
        card_group_name_source:
          owner:
            Name: communal_cards
          name: draw_pile
        card_group_name_dest:
          owner:
            RelativePlayer:
              offset_from_current_player: 0
          name: hand_cards

ending_conditions:
  - player_count: AllButOnePlayer
    card_count: 0
